# 09. 소프트웨어 개발 보안 구축

## Secure SDLC

### Secure SDLC

- SDLC에 보안 강화를 위한 프로세스를 포함한 것을 의미
- 방법론
    - CLASP : 초기 단계에서 보안을 강화하기 위해 개발된 방법론
    - SDL : 마이크로소프트 사에서 안전한 소프트웨어 개발을 위해 기존의 SDLC를 개선한 방법론
    - Seven Touchpoints : 소프트웨어 보안의 모법사례를 SDLC에 통합한 방법

### 소프트웨어 개발 보안 요소

- 소프트웨어 개발에 있어 충족시켜야 할 요소 및 요건을 의미
- 기밀성, 무결성, 가용성을 보안의 3대 요소라 한다.

| 기밀성(Confidentiality) | - 시스템 내의 정보와 자원은 인가된 사용자에게 만 접근이 허용된다.
- 정보가 전송 중에 노출되더라도 데이터를 읽을 수 없다. |
| --- | --- |
| 무결성(Integrity) | 시스템 내의 정보는 오직 인가된 사용자만 수정할 수 있다 |
| 가용성(Availability) | 인가받은 사용자는 시스템 내의 정보와 자원을 언제라도 사용 가능 |
| 인증(Authentication) | - 시스템 내의 정보와 자원을 사용하려는 사용자가 합법적인 사용자인지를 확인하는 모든 행위
- 대표적인 방법 : 패스워드, 인증용 카드, 지문 검사 등 |
| 부인 방지(NonRequdiation) | 데이터를 송,수신한 자가 송,수신 사실을 부인할 수 없도록 송,수신 증거를 제공 |

### 시큐어 코딩(Secure Coding)

- 구현 단계에서 발생할 수 있는 보안 취약점들을 최소화하기 위해 **보안 요소들을 고려하며 코딩하는 것**을 의미
- 보안 취약점을 사전 대응하여 안정성과 신뢰성을 확보한다.
- 보안 정책을 바탕으로 시큐어 코딩 가이드를 작성하고, 개발 참여자에게는 시큐어 코딩 교육을 실시

## 세션 통제

### 세션 통제

- 세션의 연결과 연결로 인해 발생하는 정보를 관리하는 것
- 요구사항 분석 및 설계 단계에서 진단해야 하는 보안 전검 내용
- 세션통제의 보안 약점
    - 불충분한 세션 관리
        - 일정한 규칙이 존재하는 세션ID가 발급되거나, 타임아웃이 너무 길게 설정되어 있는 경우 발생하는 보안 약점
    - 잘못된 세션에 의한 정보 노출
        - 다중 스레드(Multi-Thread)환경에서 멤버 변수에 정보를 저장할 때 발생하는 보안 약점

### 세션 설계 시 고려 사항

- 시스템의 모든 페이지에서 로그아웃이 가능하도록 UI를 구성
- 로그아웃 요청 시, 할당된 세션이 완전히 제거되도록 한다.
- 세션 타임아웃은 중요도가 높으면 2~5분, 낮으면 15~30분으로 설정
- 이전 세션이 종료되지 않으면 새 세션이 생성되지 못하도록 설계
- 중복 로그인을 허용하지 않는 경우, 클라이언트의 중복 접근에 대한 세션 관리 정책을 수립한다.

### 세션ID의 관리 방법

- 안전한 서버에서 최소 128비트의 길이로 생성
- 예측이 불가능하도록 안전한 난수 알고리즘 적용
- 세션ID가 노출되지 않도록 URL Rewrite 기능을 사용하지 않는 방향으로 설계
- 로그인 시 로그인 전의 세션ID를 삭제하고 재할당
- 장기간 접속하고 있는 세션ID는 주기적으로 재할당되도록 설계

### 세션 통제 관련 용어

- 세션(session) : 서버와 클라이언트의 연결을 의미
- 세션 통제 : 세션의 연결과 연결로 인해 발생하는 정보를 관리하는 것
- 세션ID(SessionID) : 서버가 클라이언트들을 구분하기 위해 부여하는 키(Key)
- 스레드(Thread) : 프로세스 내의 작업 단위로, 시스템의 자원을 할당받아 실행하는 프로그램 단위
- 다중 스레드(Muti-Thread) : 두 개 이상의 스레드가 생성되어 동시 처리되는 다중 작업(Multitasking)을 다중 스레드 또는 멀테 스레드라고 부름
- URL Rewrite : 쿠키를 사용할 수 없는 환경에서 세선ID전달을 위해 URL에 세션ID를 포함시키는 것

## 입력 데이터 검증 및 표현 관련 용어

### 입력 데이터 검증 및 표현

- 입력 데이터로 인해 바생하는 문제들을 예방하기 위해 구현 단계에서 검증해야하는 보안 점검 항목
- 경로 순회(Directory Traversal) : 경로를 탐색할 때 사용하는 ‘/’, ‘\’, ‘..’등의 기호를 악용하여 허가되지 않은 파일에 접근하는 방식
- 스크립트(Script) : 소프트웨어를 수행하는데 필요한 처리 절차가 기록된 텍스트로, 대표적인 스크립트 확장자에는 asp, jsp, php등이 있음

| 보안약점 | 설명 |
| --- | --- |
| SQL삽입(Injection) | - SQL을 삽입하여 내부 데이터베이스 서버의 데이터를 유출 및 변조하고, 관리자 인증을 우회하는 보안 약점
- 동적 쿼리에 사용되는 입력 데이터에 예약어 및 특수문자가 입력되지 않게 필터링되도록 설정하여 방지할 수 있다. |
| 크로스사이드 스크립팅(XSS) | - 웹페이지에 **악의적인 스크립트를 삽입하여 방문자들의 정보를 탈취하거나, 비정상적인 기능 수행을 유발**하는 보안 약점
- HTML 태그의 사용을 제한하거나 스크립트에 삽입되지 않도록 ‘<’, ‘>’, ‘&’등의 문자를 다른 문자를 치환함으로써 방지할 수 있다. |
| 메모리 버퍼 오버플로 | - 연속된 메모리 공간을 사용하는 프로그램에서 **할당된 메모리의 범위를 넘어선 위치에서 자료를 읽거나 쓰려고 할 때 발생하는 보안 약점**
*-* 메모리 버퍼를 사용할 경우 적절한 버퍼의 크기를 설정하고, 설정된 범위의 메모리 내에서 올바르게 읽거나 쓸 수 있도록 함으로써 방지할 수 있다. |
| 운영체제 명령어 삽입 | - 외부 입력값을 통해 시스템 명령어의 실행을 유도함으로써 권한을 탈취하거나 시스템 장애를 유발하는 보안 약점 |
| 위험한 형식 파일 업로드 | - 악의적인 명령어가 포함된 스크립트 파일을 업로드함으로써 시스템에 손상을 주거나, 시스템을 제어할 수 있는 보안 약점 |
| 신뢰되지 않은 URL 주소로 자동접속 연결 | - 입력 값으로 사이트 주소를 받는 경우, 이를 조작하여 방문자를 피싱 사이트로 유도하는 보안 약점 |

## 보안 기능

### 보안 기능

- 소프트웨어 개발의 구현 단계에서 코딩하는 기능인 인증, 접근 제어, 기밀성, 암호황 등을 올바르게 구현하기 위한 보안 점검 항목
- HTTPS(Hypertext Transfer Protocol Secure) : 웹 브라우저와 서버 간의 안전한 통신을 위해 HTTP와 암호 통신 규약을 결합한 것
- SSL(Secure Sockets Layer) : 데이터를 송,수신하는 두 커퓨터 사이, 종단 간, 즉 TCP/IP 계층과 애플리케이션 계층(HTTP, TELNET, FTP 등) 사이에 위치하여 인증, 암호화, 무결성을 보장하는 업계 표준 프로토콜
- 하드코딩(Hard-coding) : 데이터를 코드 내부에 직접 입력하여 프로그래밍하는 방식

| 보안 약점 | 설명 |
| --- | --- |
| 하드코드된 암호화키 | - 암호화된 키도 하드코드된 경우 유출 시 역계산 또는 무차별 대입 공격에 의해 탈취될 수 있다
- 상수 형태의 암호화키를 사용하지 않고, 암호화 키 생성 모듈 또는 보안이 보장된 외부 공간을 이용함으로써 방지 가능 |
| 적절한 인증 없이 중요 기능 허용 | - 보안 검사를 우회하여 인증 과정 없이 중요한 정보 또는 기능에 접근 및 변경이 가능
- 중요 정보나 기능을 수행하는 페이지에서 재인증 기능을 수행하도록 하여 방지 가능 |
| 부적절한 인가 | - 접근 제어 기능이 없는 실행 경로를 통해 정보 또는 권한을 탈취할 수 있음.
- 모든 실행 경로에 대해 접근 제어 검사를 수행하고, 사용자에게는 반드시 필요한 접근 권한을 부여하여 방지 가능 |
| 중요한 자원에 대한 잘못된 권한 설정 | - 권한 설정이 잘못된 자원에 접근하여 해당 자원을 임의로 사용할 수 있음.
- 소프트웨어 관리자만 자원들을 읽고 쓸 수 있도록 설정하고, 인가되지 않은 ㅏ용자의 중요 자원에 대한 접근 여부를 검사함으로 방지 가능 |
| 취약한 암호화 알고리즘 사용 | - 암호화된 환경 설정 파일을 해독하여 비밀번호 등의 중요한 정보를 탈취할 수 있음.
- 안전한 암호화 알고리즘을 이용하고, 업무 관련 내용이나 개인 정보 등에 대해서는 IT 보안인증사무국이 안정성을 확인한 암호 모듈을 이용함으로써 방지할 수 있음. |
| 중요 정보 평문 저장 및 전송 | - 암호화되지 않은 평문 데이터를 탈취하여 중요한 정보를 획득할 수 있음.
- 중요한 정보를 저장하거나 전송할 때는 반드시 암호화 과정을 거치도록 하고, HTTPS또는 SSL과 같은 봉나 채널을 이용함으로써 방지할 수 있음 |

## 시간 및 상태

### 시간 및 상태

- 동시 수행을 지원하는 병렬 처리 시스템이나 다수의 프로세스가 동작하는 환경에서 시간과 실행 상태를 관맇여 ㅣ스템이 원할하게 동작되도록 하기 위한 보안점검 항목들

| 보안 약점 | 설명 |
| --- | --- |
| TOCTOU 경쟁조건 | - 검사 시점(Time Of Check)과 사용 시점(Time Of Use)을 고려하지 않고 코딩하는 경우 발생하는 보안 약점 검사 시점(Time Of Check)과 사용 시점(Time Of Use)을 고려하지 않고 코딩하는 경우 발생하는 보안 약점
- 코드 내의 동기화 구문을 사용하여 해당 자원에는 한 번에 하나의 프로세스만 접근 가능하도록 구성함으로써 방지 가능 |
| 종료되지 않는 반복문 또는 재귀 함수 | - 반복문이나 재귀 함수에서 종료 조건을 정의하지 않았거나, 논리 구조상 종료될 수 없는 경우 발생하는 보안 약점
- 모든 반복문이나 재귀 함수의 수행 횟수를 제한하는 설정을 추가하거나, 종료 조건을 점검하여 반복 또는 호출의 종료 여부를 확인함으로써 방지 가능 |

## 에러 처리

### 에러 처리

- 소프트웨어 실행 중에 발생할 수 있는 오류들을 사저에 정의하여 오류로 인해 발생할 수 있는 문제들을 예방하기 위한 보안 점검 항목들

| 보안약점 | 설명 |
| --- | --- |
| 오류 메세지를 통한 정보 노출 | - 오류발색으로 실행환경, 사용자 정보, 디버깅등의 중요한 정보가 메시지를 통해 외부에 노출되는 보안 약점
- 가능한 한 내부에서만 처리되도록 하거나, 메시지를 출력할 경우 최소한의 정보 또는 사전에 준비된 메시지만 출력되도록 하여 방지 가능 |
| 오류 상황 대응 부재 | - 소프트웨어 개발 중 에러 처리를 하지 않았거나, 미비로 인해 발생하는 보안 약점
- 오류가 발생할 수 있는 부분에 에러처리 구문을 작성하고, 제어문을 활용하여 오류가 악용되지 않도록 코딩함으로써 방지 가능 |
| 부적절한 예외 처리 | - 함수의 반환값 또는 오류들을 세분화하여 처리하지 않고 광범위하게 묶어 한 번에 처리하거나, 누락된 예외가 존재할 때 발생하는 보안 약점
- 모든 함수의 반환값이 의도대로 출력되는지 확인하고, 세분화된 예외처리를 수행함으로써 방지 가능 |

## 코드 오류

### 코드 오류

- 구현 단계에서 개발자들이 코딩 중 실수하기 쉬운 형 변환, 자원 반환 등의 오류를 예방하기 위한 보안 점검 항목들

| 보안 약점 | 설명 |
| --- | --- |
| 널 포인터(Nul Pointer) 역참조 | - 널 포인터가 가리키는 메모리의 위치에 값을 저장할 때 발생하는 보안 약점
- 포인터를 이용하기 전에 널 값을 갖고 있는지 검사함으로써 방지할 수 있음 |
| 부적절한 자원 해제 | - 자원을 반환하는 코드를 누락하거나, 프로그램 오류로 할당된 자원을 반환하지 못했을 때 발생하는 보안 약점
- 프로그램 내에 자원 반환 코드가 누락되어있는지 확인하고, 오류로 인해 함수가 중간에 종료되었을 때 예외 처리에 관계없이 자원이 반환되도록 코딩함으로써 방지 가능 |
| 해제된 자원 사용 | - 이미 사용이 종료되어 반환된 메모리를 참조하는 경우 발생하는 보안 약점
- 반환된 메모리에 접근할 수 없도록 주소를 저장하고, 있는 포인터를 초기화함으로써 방지 가능 |
| 초기화 되지 않은 변수 사용 | - 변수 선언 후 값이 부여되지 않은 변수를 사용할 때 발생하는 보안 약점
- 변수 선언 시 할당된 메모리를 초기화함으로써 방지 가능 |

### 스택 가드

- 널 포인터 역참조와 같이 주소가 저장되는 스택에서 발생하는 보안 약점을 막는 기술 중 하나
- 메모리상에서 프로그램의 복귀 주소와 변수 사이에 특정 값을 저장한 후 그 값이 변경되었을 경우, 오버플로우 상태로 판단하여 프로그램 실행을 중담함으로써 잘못된 복귀 주소의 호출을 막는다

## 캡슐화

### 캡슐화

- 정보 은닉이 필요한 중요한 데이터와 기능을 불완전하게 캡슐화하거나 잘못 사용함으로쏘 발생할 수 있는 문제를 예방하기 위한 보안 점거뫙목들

### 접근 제어자

- 특정 개체를 선언할 때 외부로부터의 접근을 제한하기 위해 사용되는 예약어

## 암호 알고리즘

### 개인키 암호화(Private Key Encryption) 기법

- 동일한 키로 데이터를 암호화하고 복호화하는 암호화 기법
- 대칭 암호 기법 또는 단일키 암호화 기법이라고도 한다.
- 암호화/복호화 속도가 빠르지만, 관리해야 할 키의 수가 많다

| 스트림 암호화 방식 | - 평문과 동일한 길이의 스트림을 생성하여 **비트단위**로 암호화하는 방식
- 종류 : LFSR, RC4 |
| --- | --- |
| 블록 암호화 방식 | - 한 번에 하나의 데이터 블록을 암호화하는 방식
- 종류 : DES, SEED, AES, ARIA |

### 공개키 암호화(Public Key Encryption) 기법

- 데이터를 암호화할 때 사용되는 공개키는 사용자에게 공개하고, 복호화할 때의 비밀키는 관리자가 비밀리에 관리하는 암호화 기법
- 비대칭 암호 기법
- 관리해야 할 키의 수가 적지만, 암호화/복호화 속도가 느림
- 대표적으로 RSA(Rivest Shamir Adleman)기법

### 양방향 알고리즘의 종류

| 알고리즘 | 특징 |
| --- | --- |
|  |  |
|  |  |